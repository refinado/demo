<!DOCTYPE HTML>
<html lang="en-US">
<head>
	<meta charset="UTF-8">
	<title>瀑布流练习2</title>
	<style>
		#container{width:90%;margin:0 auto;position:relative;}
		#container div{width:140px;border:1px solid #ccc;padding:15px;position:absolute;}
		img{width:140px;}
		h3{text-align:center;}
	</style>
	<script src="js/tools.js"></script>
	<script>
/*	1.计算每行放置的盒子个数
   		大盒子能够容纳的宽度/小盒子的宽度	offsetWidth:组件大小；clientWidth:可视区大小
   	2.盒子水平间距
   		剩余宽度/(列数+1)
   	3.计算各个盒子的定位
   		先定位第一行
*/
	window.onresize = waterfall;
	window.onload = waterfall;

	function waterfall(){
		var containerWidth = $("#container").clientWidth,	//外层容器可视区宽度
			boxes = $("div",$("#container")),
			boxWidth = boxes[0].offsetWidth,	//图片盒子宽度
			cols = Math.floor(containerWidth/boxWidth),	//每行的列数
			spacing = Math.floor((containerWidth - boxWidth*cols)/(cols + 1)),	//图片盒子水平间距
			pos = [],		//存放布局时各列的 top 值
			index=0;		//当前定位布局时的盒子所在的列数
		
		for(var i=0,len=boxes.length;i<len;i++){
			if(i<cols){
				pos[i] = 10;
				index=i;
			}else{
				index = getMinIndex(pos);//找到在第几列定位				
			}
			boxes[i].style.left=(index*boxWidth+(index+1)*spacing)+"px";
			boxes[i].style.top=pos[index]+"px";
			pos[index] += 10 + boxes[i].offsetHeight;
		}

/*
//方法二 复杂一些
		//第一行盒子定位
		for(var i = 0;i<cols;i++){
			pos[i] = 10;
			boxes[i].style.left =(i*boxWidth +(i+1)*spacing) + "px";
			boxes[i].style.top = "10px";
			pos[i] += boxes[i].offsetHeight + 10;
		}

		//第一行外的其他盒子定位
		for(var i =cols;i<boxes.length;i++){
			var index = getMinIndex(pos);//找到在第几列定位
			boxes[i].style.left=(index*boxWidth+(index+1)*spacing)+"px";
			boxes[i].style.top=pos[index]+"px";
			pos[index] += 10 + boxes[i].offsetHeight;
		}*/

	//查找数组中最小值的索引
		function getMinIndex(array){
			var min = array[0],index =0;//min 最小值，index:最小值索引
			//查找最小值及索引
			for(var i =1;i<array.length;i++){
				if(array[i]<min){
					min = array[i];
					index = i;
				}
			}
			return index;
		}
	};

		
	</script>
</head>
<body>
	<div id="container">
		<div>
			<h3>标题</h3>
			<img src="img/1.jpg">
			<p>描述说明信息</p>
		</div>
		<div>
			<h3>标题</h3>
			<img src="img/2.jpg">
			<p>描述说明信息</p>
		</div>
		<div>
			<h3>标题</h3>
			<img src="img/3.jpg">
			<p>描述说明信息</p>
		</div>
		<div>
			<h3>标题</h3>
			<img src="img/4.jpg">
			<p>描述说明信息</p>
		</div>
		<div>
			<h3>标题</h3>
			<img src="img/5.jpg">
			<p>描述说明信息</p>
		</div>
		<div>
			<h3>标题</h3>
			<img src="img/6.jpg">
			<p>描述说明信息</p>
		</div>
		<div>
			<h3>标题</h3>
			<img src="img/7.jpg">
			<p>描述说明信息</p>
		</div>
		<div>
			<h3>标题</h3>
			<img src="img/8.jpg">
			<p>描述说明信息</p>
		</div>
		<div>
			<h3>标题</h3>
			<img src="img/9.jpg">
			<p>描述说明信息</p>
		</div>
		<div>
			<h3>标题</h3>
			<img src="img/10.jpg">
			<p>描述说明信息</p>
		</div>
		<div>
			<h3>标题</h3>
			<img src="img/11.jpg">
			<p>描述说明信息</p>
		</div>
		<div>
			<h3>标题</h3>
			<img src="img/12.jpg">
			<p>描述说明信息</p>
		</div>
		<div>
			<h3>标题</h3>
			<img src="img/13.jpg">
			<p>描述说明信息</p>
		</div>
		<div>
			<h3>标题</h3>
			<img src="img/14.jpg">
			<p>描述说明信息</p>
		</div>
		<div>
			<h3>标题</h3>
			<img src="img/15.jpg">
			<p>描述说明信息</p>
		</div>
		<div>
			<h3>标题</h3>
			<img src="img/16.jpg">
			<p>描述说明信息</p>
		</div>
		<div>
			<h3>标题</h3>
			<img src="img/17.jpg">
			<p>描述说明信息</p>
		</div>
		<div>
			<h3>标题</h3>
			<img src="img/18.jpg">
			<p>描述说明信息</p>
		</div>
		<div>
			<h3>标题</h3>
			<img src="img/19.jpg">
			<p>描述说明信息</p>
		</div>
	</div>
</body>
</html>